---
title: 'Matrix Factorization with Tensorflow'
date: '2017-1-16 10:00'
layout: post
published: true
---

최근 행렬분해 기반의 모델이 콘텐츠추천 분야에서 인기가 높아지고 있습니다. 행렬분해 기반의 모델은 암시적 피드백, 일시적 영향, 신뢰수준과 같은 추가 정보의 통합을 허용하며, 네플릭스 프라이즈 대회를 통해 입증된 바와 같이 고전적인 최근거리이웃(nearest-neighbor)에 기반을 둔 모델들보다 우수합니다. 이 포스트에서는 요즘 인기있는 딥러닝 도구인 tensorflow를 이용하여 행렬을 분해하는 방법을 다루어 보겠습니다. 

### Matrix factorization for recommender systems

<div style="text-align:center" markdown="1">
![]({{ site.url }}/assets/images/matrixfactorizationtensorflow-recommendersystem-1.png){:height="200px"}

Concept of simple recommender system
</div>

현대의 소비자는 다양한 선택권을 가지고 있습니다. 인터넷 소매업체 및 컨텐츠 제공업체는 엄청난 양의 제품을 제공하면서 다양한 특수한 요구사항 및 취향을 충족시킬수 있는 전례없이 다양한 기회를 제공합니다. 소비자를 그들이 잠재적으로 가장 적합할 수 있는 제품과 조화시키는 것은 사용자 만족도와 충성도를 높이는데 중요한 요소입니다. 결과적으로 더 많은 소매업체가 제품의 사용자 관심패턴을 분석하여 맞춤추천을 제공하는 추천 시스템에 관심을 가지고 있습니다. 훌륭한 개인화된 추천 제품들은 사용자경험에 또다른 차원을 추가할 수 있기 때문에, 아마존 및 넷플릭스와 같은 전자상거래의 선구자는 추천시스템을 웹사이트의 중요한 부분으로 만들었습니다.

#### Recommender system strategies

대체적으로 추천시스템은 크게 두 가지 전략 중 한가지에 기반을 둡니다. 콘텐츠필터링 접근법에서는 각 사용자 또는 제품의 특징을 추출해 내기 위한 프로파일을 작성합니다. 예를 들어, 영화 프로필에는 장르, 참여 배우, 흥행 인기도 등의 속성이 포함될 수 있습니다. 사용자 프로필에는 인구통계학적 정보 또는 적절한 설문지에 제공된 답변이 포함될 수 있습니다. 이러한 프로파일 정보는 이들과 관련이 있는 제품에 대한 힌트를 제공해 주기 때문에, 이를 이용하여 사용자와 일치하는 제품과 서로 연결할 수 있습니다. 물론, 이러한 콘텐츠기반의 전략을 적용하려면 개인선호도 등을 포함한 수집하기 용이하지 않은 외부정보를 수집할 필요가 있습니다.

콘텐츠필터링의 성공적인 실현은 인터넷 라디오 서비스인 판도라에 사용되는 음악게놈 프로젝트입니다. 여기서, 숙련된 음악 분석가는 수백 가지의 독특한 음악적 특성을 기반으로 음악게놈 프로젝트의 각 노래에 점수를 매 깁니다. 이러한 속성 또는 유전자는 노래의 음악적 정체성뿐만 아니라 청취자의 음악적 취향을 이해하는데 있어서 많은 중요한 특성을 포착합니다.

콘텐츠필터링에 대한 대안적 방안은 명시적인 프로필을 만들지 않고 이전거래 또는 제품등급과 같은 과거의 사용자 행동에만 의존합니다. 이 접근법은 협력적필터링(collaborative filtering)으로 알려져 있습니다. 이 용어는 최초의 추천시스템인 Tapestry의 개발자에 의해 만들어졌습니다. 협력적필터링은 사용자간의 관계 및 제품 간의 상호의존성을 분석하여 새로운 가능한 사용자-항목간의 연결을 찾아냅니다.

협력적필터링의 가장 큰 매력은 분야에 종속적이지 않다는 것입니다. 즉, 분야에 특이적인 지식을 요구하지 않는다는 점입니다. 컨텐츠필터링을 사용하여 파악하기가 어려운 문제나, 프로필 작성이 어려운 데이터 측면의 문제를 처리할 수 있습니다. 협력적필터링은 일반적으로 컨텐츠 기반 기술보다 정확한 반면, 시스템의 신제품 및 새로운 사용자를 처리할 수 없는 문제가 있습니다. 이를 콜드 *콜드스타트*문제라고 부릅니다. 이 측면에서는 컨텐츠필터링이 우수합니다.

협력적필터링 접근의 주요한 두 영역은 이웃기반방법(neighborhood methods)과 잠재인자모델(latent factor model)입니다. 이웃기반방법은 아이템간 또는 사용자간의 관계를 계산하는데 중점을 둡니다. 아이템지향적 접근법은 항목에 대한 사용자 선호도를 평가하기 위해서 동일한 유저가 부여한 "인접한"항목에 매긴 점수를 참고합니다. 이웃 제품이란 동일한 사용자가 등급을 매길 때 유사한 등급을 부여하는 경향이 있는 다른 제품입니다. 예를 들어, 영화 *라이언일병구하기*를 생각해 보십시오. 이 영화의 이웃으로는 전쟁 영화, 스필버그 영화, 톰행크스 영화 등이 포함될수 있습니다. 영화 *라이언일병구하기*에 대한 다른 특정사용자의 평가등급을 예측하려면 이 사용자가 실제로 평가한 가장 가까운 이웃이 무엇인지 찾을 필요가 있습니다. 그림 1에서 볼수 있듯이 사용자중심의 접근방식은 서로의 등급을 보완할 수 있는 마음이 맞는 사용자를 찾아냅니다.

> Tensorflow의 출시와 함께, 여러 개발자들이 이를 이용한 알고리즘을 개발하려고 노력중입니다. 여기서는 tensorflow를 이용한 행렬의 분해에 관한 하나의 시도를 소개합니다. 원문은 [여기](...)에서 확인할 수 있습니다.
> [recommender systems]({{ site.url }}/assets/papers/Koren et al. - 2009 - Matrix factorization techniques for recommender sy.pdf) 

> 작업중... 
